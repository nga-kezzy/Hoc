CREATE DATABASE Nv_Nga_Bai_5_5
use Nv_Nga_Bai_5_5
-- Tao Bang Du Lieu --

create table CONGTRINH
	(MACT		CHAR(5)		NOT NULL,
	TENCT		CHAR(20)	NOT NULL,
	DIADIEM		CHAR(20)	NOT NULL,
	NGAYCAPGP	DATE		NOT NULL,
	NGAYKC		DATE		NOT NULL,
	NGAYHT		DATE		NOT NULL,
	PRIMARY KEY (MACT))

CREATE TABLE NHANVIEN
	(MANV		CHAR(5)		NOT NULL,
	HOTEN		CHAR(20)	NOT NULL,
	NGAYSINH	DATE		NOT NULL,
	GIOI		CHAR(4)		NOT NULL,
	DIACHI		CHAR(30)	NOT NULL,
	MAPB		CHAR(5)		NOT NULL,
	PRIMARY KEY (MANV))

CREATE TABLE PHONGBAN
	(MAPB		CHAR(5)		NOT NULL,
	TENPB		CHAR(16)	NOT NULL,
	PRIMARY KEY (MAPB))

CREATE TABLE PHANCONG
	(MACT		CHAR(5)		NOT NULL,
	MANV		CHAR(5)		NOT NULL,
	SLNGAYCONG	INTEGER		NOT NULL,
	PRIMARY KEY (MACT,MANV),
	FOREIGN KEY	(MACT) REFERENCES CONGTRINH,
	FOREIGN KEY (MANV) REFERENCES NHANVIEN)

INSERT INTO CONGTRINH(MACT,TENCT,DIADIEM,NGAYCAPGP,NGAYKC,NGAYHT)
VALUES
('N1','NHA SO 1','HA NOI','02/05/2019','02/06/2019','01/01/2020'), 
('N2','NHA SO 2','HAI PHONG','05/05/2018','02/06/2018','01/01/2019'),
('N3','NHA SO 3','DA LAT','02/5/2016','02/06/2016','01/01/2017');

INSERT INTO PHONGBAN(MAPB,TENPB)
VALUES
('PB1','PHONG BAN 1'),
('PB2','PHONG BAN 2');

INSERT INTO NHANVIEN(MANV,HOTEN,NGAYSINH,GIOI,DIACHI,MAPB)
VALUES
('NV1','NGUYEN VAN A','12/2/1999','NAM','HA NOI','PB1'),
('NV2','NGUYEN VAN B','02/5/1998','NAM','HA NOI','PB2'),
('NV3','NGUYEN THI C','05/09/2000','NU','HA NOI','PB2');

INSERT INTO PHANCONG(MACT,MANV,SLNGAYCONG)
VALUES
('N1','NV1',15),
('N2','NV2',20),
('N3','NV3',19),
('N1','NV2',10),
('N3','NV2',5);


--lấy ds nhân viên tham gia vào ct có mã CT1 --

SELECT NHANVIEN.MANV, HOTEN, SLNGAYCONG
FROM NHANVIEN, PHANCONG
WHERE 
  NHANVIEN.MANV = PHANCONG.MANV 
AND
  MACT = 'N1'

